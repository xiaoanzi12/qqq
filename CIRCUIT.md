# 电路连接说明

## 硬件连接图

### 完整电路连接

```
                    STC15F2K60S2单片机
                   ┌─────────────────┐
                   │                 │
              VCC──┤VCC          P1.0├──[330Ω]──LED0──VCC
              GND──┤GND          P1.1├──[330Ω]──LED1──VCC
                   │             P1.2├──[330Ω]──LED2──VCC
   [11.0592MHz]    │             P1.3├──[330Ω]──LED3──VCC
    晶振1──────────┤XTAL1        P1.4├──[330Ω]──LED4──VCC
    晶振2──────────┤XTAL2        P1.5├──[330Ω]──LED5──VCC
                   │             P1.6├──[330Ω]──LED6──VCC
  复位按钮─────────┤RST          P1.7├──[330Ω]──LED7──VCC
   (与10K上拉)     │                 │
                   └─────────────────┘

说明：
- 晶振两端各接30pF电容到地
- 复位电路：RST引脚接10K上拉电阻到VCC，按钮到GND
- 所有LED共阳极接到VCC，阴极通过限流电阻接P1口
```

## LED连接详细说明

### 共阳极接法（程序默认，推荐）

```
          VCC (+5V)
            │
    ┌───────┼───────┬───────┬───────┬───────┬───────┬───────┬───────┐
    │       │       │       │       │       │       │       │       │
   LED0    LED1    LED2    LED3    LED4    LED5    LED6    LED7
    │(+)    │(+)    │(+)    │(+)    │(+)    │(+)    │(+)    │(+)
    │(-)    │(-)    │(-)    │(-)    │(-)    │(-)    │(-)    │(-)
    │       │       │       │       │       │       │       │       │
   330Ω    330Ω    330Ω    330Ω    330Ω    330Ω    330Ω    330Ω
    │       │       │       │       │       │       │       │       │
   P1.0    P1.1    P1.2    P1.3    P1.4    P1.5    P1.6    P1.7
    │       │       │       │       │       │       │       │       │
    └───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┘
                          STC15单片机P1口
```

**工作原理**：
- LED阳极(+)连接到VCC (+5V)
- LED阴极(-)通过限流电阻连接到P1口
- 当P1.x = 0（低电平）时，形成回路，LED点亮
- 当P1.x = 1（高电平）时，无电流，LED熄灭

**优点**：
- 适合P1口驱动（P1有内部上拉）
- 灌电流模式，驱动能力强
- 电路简单可靠

### 共阴极接法（可选）

```
          GND
            │
    ┌───────┼───────┬───────┬───────┬───────┬───────┬───────┬───────┐
    │       │       │       │       │       │       │       │       │
   LED0    LED1    LED2    LED3    LED4    LED5    LED6    LED7
    │(-)    │(-)    │(-)    │(-)    │(-)    │(-)    │(-)    │(-)
    │(+)    │(+)    │(+)    │(+)    │(+)    │(+)    │(+)    │(+)
    │       │       │       │       │       │       │       │       │
   330Ω    330Ω    330Ω    330Ω    330Ω    330Ω    330Ω    330Ω
    │       │       │       │       │       │       │       │       │
   P1.0    P1.1    P1.2    P1.3    P1.4    P1.5    P1.6    P1.7
    │       │       │       │       │       │       │       │       │
    └───────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┘
                          STC15单片机P1口
```

**工作原理**：
- LED阴极(-)连接到GND
- LED阳极(+)通过限流电阻连接到P1口
- 当P1.x = 1（高电平）时，形成回路，LED点亮
- 当P1.x = 0（低电平）时，无电流，LED熄灭

**注意**：使用此接法需要修改程序中的LED_TABLE数组

## 元件清单

| 序号 | 元件名称 | 规格参数 | 数量 | 说明 |
|------|----------|----------|------|------|
| 1 | STC15F2K60S2 | DIP-40封装 | 1 | 主控单片机 |
| 2 | LED | 5mm, 红/绿/黄色 | 8 | 发光二极管 |
| 3 | 限流电阻 | 330Ω-1KΩ, 1/4W | 8 | LED限流 |
| 4 | 晶振 | 11.0592MHz | 1 | 系统时钟 |
| 5 | 瓷片电容 | 30pF | 2 | 晶振负载电容 |
| 6 | 复位电阻 | 10KΩ, 1/4W | 1 | 上拉电阻 |
| 7 | 复位按钮 | 轻触开关 | 1 | 手动复位 |
| 8 | 电源电容 | 10μF电解+0.1μF瓷片 | 各1 | 电源滤波 |
| 9 | 电源 | +5V直流 | 1 | 系统供电 |
| 10 | 面包板/万能板 | - | 1 | 电路搭建 |
| 11 | 杜邦线 | 若干 | - | 连接线 |

## 限流电阻选择

LED的限流电阻计算公式：

```
R = (Vcc - Vled) / Iled
```

其中：
- Vcc = 5V（电源电压）
- Vled = 1.8-2.2V（LED正向压降，红色约1.8-2.0V，绿色/黄色约2.0-2.2V）
- Iled = 5-20mA（LED工作电流，一般取10mA）

### 计算示例

以红色LED为例（Vled=2V，Iled=10mA）：

```
R = (5V - 2V) / 10mA = 3V / 0.01A = 300Ω
```

实际选用：330Ω（标准阻值）

### 常用阻值参考

| LED颜色 | 推荐电阻 | 亮度 | 电流 |
|---------|----------|------|------|
| 红色 | 330Ω | 中等 | ~9mA |
| 红色 | 470Ω | 较暗 | ~6mA |
| 红色 | 220Ω | 较亮 | ~13mA |
| 绿/黄色 | 330Ω | 中等 | ~8mA |
| 绿/黄色 | 470Ω | 较暗 | ~6mA |
| 白/蓝色 | 220Ω | 中等 | ~10mA |

**建议**：
- 一般使用330Ω或470Ω
- 如需更亮，可用220Ω
- 如需省电，可用1KΩ（亮度会降低）

## 最小系统电路

STC15单片机最小系统包括：

### 1. 电源电路

```
VCC(+5V)────┬────[10μF电解电容]────GND
            │
            └────[0.1μF瓷片电容]──GND
            │
            └────单片机VCC引脚
```

### 2. 晶振电路

```
          XTAL1              XTAL2
            │                  │
            ├──[11.0592MHz]────┤
            │                  │
         [30pF]             [30pF]
            │                  │
           GND                GND
```

### 3. 复位电路

```
VCC(+5V)────[10KΩ]────┬────RST引脚
                      │
                   [按钮]
                      │
                     GND
```

**说明**：
- 按下按钮时RST接地，单片机复位
- 松开按钮时RST通过10K电阻上拉到VCC，正常运行

## PCB布局建议

### 布局原则

1. **电源部分**
   - 电源输入端放置滤波电容
   - 电源线尽量粗，减小压降

2. **单片机部分**
   - 单片机放在中央位置
   - 晶振尽量靠近单片机
   - 晶振走线要短，避免干扰

3. **LED部分**
   - LED可排成一排或圆形
   - 限流电阻靠近LED或靠近单片机
   - 建议预留LED方向标识

4. **地线处理**
   - 数字地和模拟地分开
   - 地线尽量粗，形成地平面

### 推荐布局

```
┌─────────────────────────────────┐
│  +5V电源输入    滤波电容        │
├─────────────────────────────────┤
│                                 │
│     LED0  LED1  LED2  LED3      │
│      │     │     │     │        │
│     [R]   [R]   [R]   [R]       │
│                                 │
│          STC15单片机             │
│        ┌─────────────┐          │
│  晶振──┤             │          │
│        │   芯片      │          │
│  复位──┤             │          │
│        └─────────────┘          │
│                                 │
│     [R]   [R]   [R]   [R]       │
│      │     │     │     │        │
│     LED4  LED5  LED6  LED7      │
│                                 │
└─────────────────────────────────┘
```

## 调试说明

### 硬件调试步骤

1. **电源检查**
   - 使用万用表测量VCC和GND之间电压是否为5V
   - 检查是否有短路

2. **单片机供电检查**
   - 测量单片机VCC引脚电压
   - 测量单片机GND引脚是否良好接地

3. **晶振检查**
   - 使用示波器观察晶振是否起振
   - 正常情况下应看到正弦波或方波

4. **P1口电平检查**
   - 下载程序后，使用万用表或示波器测量P1口电平
   - 应能看到P1.0-P1.7依次输出低电平

5. **LED检查**
   - 检查LED极性是否正确
   - 单独给LED加电测试是否能亮
   - 检查限流电阻是否接对

### 常见故障排除

| 故障现象 | 可能原因 | 解决方法 |
|---------|---------|---------|
| 所有LED不亮 | 电源未接通 | 检查电源连接 |
| 所有LED不亮 | 程序未下载 | 重新下载程序 |
| 所有LED常亮 | LED极性接反 | 调整LED方向 |
| 部分LED不亮 | 该LED损坏 | 更换LED |
| 部分LED不亮 | 引脚接触不良 | 重新连接 |
| 流水不规律 | 晶振未起振 | 检查晶振电路 |
| 速度异常 | 晶振频率不对 | 更换合适晶振 |

## 实物接线示例

### 使用面包板搭建

```
步骤1：插入STC15单片机（注意方向，凹槽朝左）
步骤2：连接电源和地线到面包板的电源轨
步骤3：单片机VCC引脚连接到+5V电源轨
步骤4：单片机GND引脚连接到GND电源轨
步骤5：连接晶振电路（XTAL1、XTAL2及两个30pF电容）
步骤6：连接复位电路（RST、10K电阻、按钮）
步骤7：依次连接8个LED及限流电阻到P1.0-P1.7
步骤8：检查接线无误后上电测试
```

### 注意事项

1. **极性问题**
   - LED有极性，长脚为阳极(+)，短脚为阴极(-)
   - 电解电容有极性，注意正负极

2. **静电防护**
   - 单片机是静电敏感器件
   - 操作前先触摸接地金属释放静电

3. **供电电压**
   - STC15工作电压范围：3.3V-5.5V
   - 推荐使用5V稳压电源

4. **散热问题**
   - 8个LED同时点亮时电流较大
   - 注意单片机和电源的散热

## 扩展电路

### 添加电源指示灯

```
VCC(+5V)────[1KΩ]────LED(电源指示)────GND
```

### 添加按键控制

```
VCC(+5V)────[10KΩ]────┬────P3.2(INT0)
                      │
                   [按钮]
                      │
                     GND
```

可通过按键切换流水模式或调整速度。

---

**祝您搭建成功！有问题请查阅README.md或联系技术支持。**
